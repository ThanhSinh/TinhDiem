<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tính tổng điểm cược</title>
    <style>
        h2 {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            background-color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 60px; /* Thêm margin-top để tránh chạm vào tiêu đề */
        }
        label[for="playerName"] {
            margin-top: 30px; /* Đảm bảo khoảng cách giữa nhãn và tiêu đề */
            display: block; /* Đảm bảo dòng mới cho nhãn */
        }
        .form-container {
            margin-bottom: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            transition: margin-top 0.3s ease; /* Thêm transition cho hiệu ứng mượt */
        }
        .form-container:not(:first-child) {
            margin-top: 20px; /* Thêm margin-top cho các form ngoại trừ form đầu tiên */
        }
        .fixed-form {
            position: fixed;
            top: 60px; /* Cố định form đầu tiên ở vị trí này */
            z-index: 999;
            background-color: #fff;
            width: calc(100% - 40px); /* Chiều rộng bằng container */
            left: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
      
        <div id="formsContainer"></div>
        <button id="addPlayerBtn">Thêm người chơi khác</button>
        <button id="calculateTotalBtn">Tính tổng</button>
        <button id="viewHistoryBtn">Xem lịch sử</button>
        <button id="clearHistoryBtn">Xóa lịch sử</button>
        <div id="players"></div>
        <div id="history"></div>
    </div>

    <script>
        var players = {};
        var historyVisible = false;

        document.getElementById("addPlayerBtn").addEventListener("click", function() {
            createForm();
        });

        document.getElementById("calculateTotalBtn").addEventListener("click", function() {
            calculateTotal();
        });

        document.getElementById("viewHistoryBtn").addEventListener("click", function() {
            toggleHistory();
        });

        document.getElementById("clearHistoryBtn").addEventListener("click", function() {
            clearHistory();
        });

        function createForm() {
            var formsContainer = document.getElementById("formsContainer");
            var form = document.createElement("form");
            form.classList.add("form-container");
            form.innerHTML = `
                <label for="playerName">Tên người chơi:</label>
                <input type="text" class="playerName" required><br>
                <label for="betAmount">Nhập điểm cược: </label><br>
                <input type="number" class="betAmount" required><br>
                <label for="result">Chọn kết quả:</label>
                <select class="result" required>
                    <option value="win">Thắng</option>
                    <option value="lose">Thua</option>
                    <option value="draw">Hòa</option>
                </select><br>
            `;
            formsContainer.appendChild(form);
        }

        function calculateTotal() {
            var forms = document.querySelectorAll(".form-container");
            forms.forEach(function(form) {
                var playerName = form.querySelector(".playerName").value;
                var betAmount = parseFloat(form.querySelector(".betAmount").value);
                var result = form.querySelector(".result").value;

                if (!players[playerName]) {
                    players[playerName] = { total: 0, bets: [] };
                }
                if (result === "win") {
                    players[playerName].total += betAmount;
                } else if (result === "lose") {
                    players[playerName].total -= betAmount;
                }
                players[playerName].bets.push({ amount: betAmount, result: result });
            });

            updatePlayers();
            localStorage.setItem('betHistory', JSON.stringify(players));
            updateHistory();
        }

        function updatePlayers() {
            var playersElement = document.getElementById("players");
            playersElement.innerHTML = "";
            Object.keys(players).forEach(function(player) {
                var playerInfo = "<div class='player-info'>";
                playerInfo += "<p>" + player + " - Tổng điểm cược: " + players[player].total + "</p>";
                playerInfo += "</div>";
                playersElement.innerHTML += playerInfo;
            });
        }

        function updateHistory() {
            var historyElement = document.getElementById("history");
            historyElement.innerHTML = "";
            var betHistory = JSON.parse(localStorage.getItem('betHistory')) || {};
            if (Object.keys(betHistory).length === 0) {
                historyElement.innerHTML = "<p>Chưa có lịch sử cược.</p>";
                return;
            }
            historyElement.innerHTML += "<h3>Lịch sử cược:</h3>";
            Object.keys(betHistory).forEach(function(player) {
                var playerInfo = "<div class='player-info'>";
                playerInfo += "<p>" + player + " - Tổng điểm cược: " + betHistory[player].total + "</p>";
                playerInfo += "<ul>";
                betHistory[player].bets.forEach(function(bet, index) {
                    var betResult;
                    if (bet.result === "win") {
                        betResult = "Thắng";
                    } else if (bet.result === "lose") {
                        betResult = "Thua";
                    } else {
                        betResult = "Hòa";
                    }
                    playerInfo += "<li>Ván " + (index + 1) + ": " + bet.amount + " điểm - Kết quả: " + betResult + "</li>";
                });
                playerInfo += "</ul></div>";
                historyElement.innerHTML += playerInfo;
            });
            if (historyVisible) {
                historyElement.style.display = "block";
            } else {
                historyElement.style.display = "none";
            }
        }

        function toggleHistory() {
            historyVisible = !historyVisible;
            updateHistory();
        }

        function clearHistory() {
            localStorage.removeItem('betHistory');
            updateHistory();
        }

        window.onload = function() {
            updatePlayers();
            updateHistory();
        };
    </script>
</body>
</html>
